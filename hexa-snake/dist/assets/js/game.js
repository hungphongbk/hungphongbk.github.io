var extend=function(t,e){function n(){this.constructor=t}for(var i in e)hasProp.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;!function(t,e,n,i){var r,s,o,a,h,u,c,p;return p=function(t){return Math.floor(Math.random()*(t+1))},s=function(){function t(t,e){this.x=t,this.y=e,this.map=o.instance,this.sprite=null}return t.prototype.renderPosW=function(){return this.map.renderUnitW*this.x},t.prototype.renderPosH=function(){return this.map.renderUnitH*this.y},t.prototype.next=function(t){var e,n;switch(n=this.map.unitW,e=this.map.unitH,t){case 0:return this.map.find(this.x+n/2,this.y-e);case 1:return this.map.find(this.x+n,this.y);case 2:return this.map.find(this.x+n/2,this.y+e);case 3:return this.map.find(this.x-n/2,this.y+e);case 4:return this.map.find(this.x-n,this.y);case 5:return this.map.find(this.x-n/2,this.y-e)}},t}(),o=function(){function t(){}var e,n,i,r;return r=null,e=.001,i=function(t,n){return Math.abs(t-n)<e},n=function(){function t(t,e,n){this.unitH=.795,this.unitW=Math.sqrt(3)/2,this.renderUnitW=n*this.unitW,this.renderUnitH=n*this.unitH,this.width=Math.floor(t/this.renderUnitW),this.height=Math.floor(e/this.renderUnitH),this.hexagonArray=[]}return t.prototype.initHexagonArray=function(){var t,e,n;for(this.hexagonArray=[],n=3*this.unitW/2,e=this.unitH,t=!0;;)if(this.hexagonArray.push(new s(n,e)),n+=this.unitW,n>this.width-this.unitW/2&&(e+=this.unitH,t=!t,n=t?3*this.unitW/2:this.unitW),!(e<this.height))break},t.prototype.find=function(t,e){var n,r,s,o,a;for(o=this.hexagonArray,r=0,s=o.length;s>r;r++)if(n=o[r],i(t,n.x)&&i(e,n.y)){a=n;break}return a},t.prototype.test=function(){var t;return t=this.hexagonArray[4],console.log(t),t=t.next(3),console.log(t),t=t.next(3),console.log(t),t=t.next(1),console.log(t)},t}(),t.config=function(t,e,i){return null==i&&(i=20),r=new n(t,e,i),r.initHexagonArray(),console.log("HexaGon Map initialized with"),console.log("- size "+t+" x "+e+" and unitSize = "+i),console.log("- number of hexa tiles is "+r.hexagonArray.length)},Object.defineProperty(t,"instance",{get:function(){return r}}),t}(),r=function(t){function e(t,n,i){var r;null==i&&(i=0),e.__super__.constructor.call(this,t,n.renderPosW(),n.renderPosH(),"snake"),this.pushType(i),r=.15,this.scale.setTo(r,r),this.anchor.setTo(.5,.5),n.sprite=this}return extend(e,t),e.TILE_BACKGROUND=0,e.TILE_WALL=1,e.TILE_SNAKEBODY=2,e.TILE_SNAKEHEAD=3,e.TILE_FOOD=4,e.prototype.pushType=function(t){return this.frame=t},e.prototype.popType=function(){return this.frame=0},e}(n.Sprite),a=function(){function t(t){this.game=t,this.length=10,this.direction=1,this.map=o.instance,this._array=[]}return t.prototype.init=function(){var t,e,n;for(t=e=0,n=this.length-1;n>=0?n>=e:e>=n;t=n>=0?++e:--e)this._array.push(this.map.hexagonArray[t]);return this._flush(),console.log(this._array)},t.prototype._flush=function(){var t,e,n,i;for(i=[],t=e=0,n=this.length-1;n>=0?n>=e:e>=n;t=n>=0?++e:--e)i.push(this._array[t].sprite.pushType(t===this.length-1?r.TILE_SNAKEBODY:r.TILE_SNAKEHEAD));return i},t.prototype.move=function(){var t,e,n,i;return i=this._array,e=i[0],t=i[i.length-1],e.sprite.popType(),this._array.shift(),n=t.next(this.direction),console.log(n),this._array.push(n),this._flush()},t.prototype.setMoveClockwise=function(){return this.direction=(this.direction+1)%6,console.log("move "+this.direction)},t.prototype.setMoveCounterClockwise=function(){return this.direction--,this.direction<0?this.direction+=6:void 0},t}(),u=function(t){function e(t){this.game=t,e.__super__.constructor.call(this,this.game),this.textStyle={font:"90px HelveticaNeue",align:"center",fill:"#888888"},this.timerText=null,this.timer=null,this.timerEvent=null,this.seconds=1}return extend(e,t),e.prototype.preload=function(){return o.config(this.game.width,this.game.height,40)},e.prototype.create=function(){return this.timerText=this.game.add.text(this.game.world.centerX,this.game.world.centerY,"3",this.textStyle),this.timerText.anchor.setTo(.5,.5),this.timer=this.game.time.create(),this.timerEvent=this.timer.add(n.Timer.SECOND*this.seconds,this.endTimer,this),this.timer.start()},e.prototype.endTimer=function(){return this.timer.stop(),this.game.state.start("Play")},e.prototype.render=function(){return this.timer.running?this.timerText.setText(Math.ceil((this.timerEvent.delay-this.timer.ms)/1e3)):void 0},e}(n.State),c=function(t){function e(t){e.__super__.constructor.call(this,t),this.snake=null}var n,i;return extend(e,t),n=0,i=null,e.prototype.preload=function(){return this.game.load.spritesheet("snake","dist/assets/images/HexaSprites_HexaSprites.png",208,208,5)},e.prototype.create=function(){var t,e,n,s;for(s=o.instance.hexagonArray,t=0,e=s.length;e>t;t++)n=s[t],game.add.existing(new r(game,n,0));return this.snake=new a(game),this.snake.init(),i=game.input.keyboard.createCursorKeys()},e.prototype.update=function(){var t;return t=this.navigationDetect(),n++,n%10===0?(1===t?this.snake.setMoveClockwise():2===t&&this.snake.setMoveCounterClockwise(),this.snake.move()):void 0},e.prototype.navigationDetect=function(){return i.right.isDown?1:i.left.isDown?2:0},e}(n.State),h=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.initStates()}return extend(e,t),e.prototype.initStates=function(){return this.state.add("Loading",u),this.state.add("Play",c),this.state.start("Loading")},e}(n.Game),function(){var t,e,n;return t="GameController",n=function(t,e){return t.trim()+" as "+e.trim()},e=i.module("SnakeApp",["ui.router","ngAnimate"]),e.config(["$stateProvider","$urlRouterProvider",function(e,i){e.state("red",{url:"/red",templateUrl:"red.html"}).state("green",{url:"/green",templateUrl:"green.html",controller:n(t,"game")}).state("blue",{url:"/blue",templateUrl:"blue.html"}),i.otherwise("/red")}]),e.controller(t,["$scope","$state",function(t){return function(e,n){t.game=null,t.initGame=function(e,n){return t.game=new h(e,n,Phaser.AUTO,"snakeGame",null,!0)},e.initGame=t.initGame,e.$on("$destroy",function(){return t.game.destroy()})}}(this)]),e.directive("game",["$injector",function(t){return{scope:{gameName:"@",onInit:"&"},template:"<div class='game-screen'></div>",replace:!0,compile:function(t){return{pre:function(e){t.attr("id",e.gameName+"Game")},post:function(e,n,i,r){var s,o;s=parseInt(t.height(),10),o=parseInt(t.width(),10),console.log(s,o),e.onInit()(o,s)}}}}}])}()}(jQuery,window,Phaser,angular);
//# sourceMappingURL=../maps/game.js.map
